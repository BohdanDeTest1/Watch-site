<!--<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Moonactive - Query Creator</title>
    <link rel="stylesheet" href="QueryCreator.css" />
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</head>

<body>
    <div id="header"></div>

    <div style="height: 60px;"></div> 

    <main class="constructor-page">
        <h1>Query Creator</h1>
        <h3>Moonactive</h3>
        <div class="constructor-container">
            <div class="watch-preview-box">

            </div>

        </div>
    </main>

    <div id="footer"></div>
    <script src="QueryCreator.js"></script>

</body>

</html>
-->
<!-- Файл: test_analytics_query_creator/querycreator.html -->
<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Конфигуратор</title>
    <link rel="stylesheet" href="QueryCreator.css">
</head>

<body>

    <header class="container">
        <h1>Query Creator</h1>
        <h3>Moonactive</h3>
        <p class="muted">
            Вставь (Ctrl/Cmd+V) скопированную таблицу из Google Sheets.
            Столбцы <strong>Event</strong> и <strong>Property</strong> будут определены автоматически.
        </p>
    </header>

    <main class="container grid">
        <section class="card">
            <h2>1) Вставка таблицы</h2>
            <label class="label">Данные из Google Sheets</label>
            <textarea id="pasteArea" placeholder="Вставь сюда строки (обычно TSV из Google Sheets)"></textarea>

            <div class="row">
                <div class="field">
                    <div class="field">
                        <label class="label">Источник данных</label>
                        <select id="tableEnv">
                            <option value="stage">Stage / RC</option>
                            <option value="prod">Production</option>
                        </select>
                    </div>
                </div>
                <div class="field">
                    <label class="label">Режим генерации</label>
                    <select id="mode">
                        <option value="property_in">WHERE event = ... AND property IN (...)</option>
                        <option value="distinct_props">SELECT DISTINCT property WHERE event = ...</option>
                    </select>
                </div>
            </div>

            <!-- ↓↓↓ Новый блок Дата ↓↓↓ -->
            <div class="row" id="dateRow">
                <div class="field">
                    <label class="label">Дата</label>

                    <div class="date-col">
                        <!-- Линия 1: Сегодня -->
                        <label class="date-option">
                            <input type="radio" name="dateMode" id="dateModeToday" checked>
                            Сегодня (<span id="todayText"></span>)
                        </label>

                        <!-- Линия 2: Диапазон + поля дат в своей строке -->
                        <div class="date-option">
                            <label class="inline">
                                <input type="radio" name="dateMode" id="dateModeRange">
                                Диапазон
                            </label>

                            <div class="date-range" id="dateRangeWrap" style="display:none;">
                                <input type="date" id="dateStart" style="max-width:180px;">
                                <input type="date" id="dateEnd" style="max-width:180px;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ↑↑↑ Новый блок Дата ↑↑↑ -->


            <div class="row">
                <button id="parseBtn">Разобрать таблицу</button>
                <button id="refreshBtn" class="btn-refresh">Refresh</button>
            </div>
            <div id="errorBox" class="hidden"></div>
            <div id="infoBox" class="hidden"></div>
            <span id="parseStatus" class="muted small"></span>

            <div id="eventPicker" class="row" style="display:none;">
                <div class="field">
                    <label class="label">Events</label>
                    <!-- multiple + высота списка -->
                    <select id="eventSelect" multiple size="8"></select>
                    <label class="label" style="margin-top:8px; display:flex; gap:8px; align-items:center;">
                        <input type="checkbox" id="selectAllEvents"> Выбрать все
                    </label>
                </div>
                <button id="genBtn">Сгенерировать SQL</button>
            </div>

        </section>

        <section class="card">
            <h2>2) Результат</h2>
            <label class="label">SQL запрос</label>
            <textarea id="sqlOutput" readonly placeholder="Здесь появится SQL"></textarea>
            <div class="row">
                <button id="copyBtn">Скопировать</button>
                <span id="copyStatus" class="muted"></span>
            </div>

            <details class="help">
                <summary>Как это работает?</summary>
                <ol>
                    <li>Скопируй строки из Google Sheets (они попадают как TSV — табами разделённые).</li>
                    <li>Нажми «Разобрать таблицу» — скрипт найдёт столбцы <em>Event</em> и <em>Property</em> (регистр не
                        важен).</li>
                    <li>Выбери нужный Event и нажми «Сгенерировать SQL».</li>
                </ol>
            </details>
        </section>
    </main>

    <footer class="container muted small">
        Сделано для быстрого прототипа. Позже можно добавить загрузку CSV, предпросмотр и фильтры.
    </footer>
    <script src="QueryCreator.js"></script>
</body>

</html>